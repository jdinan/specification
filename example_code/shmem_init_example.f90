PROGRAM PUT
INCLUDE "shmem.fh"

INTEGER TARG, SRC, RECEIVER
COMMON /T/ TARG
PARAMETER (RECEIVER=1)
INTEGER SHMEM_MY_PE
CALL SHMEM_INIT()

IF (SHMEM_MY_PE() .EQ. 0) THEN
    SRC = 33
    CALL SHMEM_INTEGER_PUT(TARG, SRC, 1, RECEIVER)
ENDIF

CALL SHMEM_BARRIER_ALL           ! SYNCHRONIZES SENDER AND RECEIVER

IF (SHMEM_MY_PE() .EQ. RECEIVER) THEN
    PRINT*,'PE ', SHMEM_MY_PE(),' TARG=',TARG,' (expect 33)'
ENDIF

CALL SHMEM_FINALIZE()

END
